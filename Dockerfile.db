FROM postgres:16

# Install build dependencies for AGE and pgvector
RUN apt-get update && apt-get install -y --no-install-recommends     build-essential     libpq-dev     postgresql-server-dev-16     git     flex     bison     postgresql-16-pgvector     ca-certificates &&     rm -rf /var/lib/apt/lists/*

# Clone, build, and install Apache AGE
# See https://age.apache.org/age-manual/master/intro/setup.html for reference
RUN git clone --branch PG16 https://github.com/apache/age.git /age_source &&     cd /age_source &&     make PG_CONFIG=/usr/bin/pg_config install

# Clean up source
RUN rm -rf /age_source